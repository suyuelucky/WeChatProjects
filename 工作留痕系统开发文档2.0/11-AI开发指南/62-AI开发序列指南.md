# 绣花针项目 - 工作留痕系统AI开发序列指南

## 文档目的

本文档为利用AI助手（如Claude）开发工作留痕系统提供结构化指南，旨在：

1. **最大化AI能力**：合理分配AI资源，确保每次会话高效产出
2. **控制开发质量**：避免常见的AI开发陷阱和问题
3. **保持开发连续性**：建立清晰的开发序列和交接机制
4. **降低认知负担**：减少开发者的协调和管理成本

## AI开发特性与挑战

### AI助手的关键特性

- **上下文容量有限**：通常受限于一定token数量（约60-80k）
- **无持久记忆**：每次会话开始时不会记得之前的开发内容
- **代码理解能力强**：能快速理解已有代码结构和目的
- **创建新代码高效**：较人类更快速地编写符合规范的新代码
- **可能存在"幻觉"**：有时会误以为某些功能已实现或可用

### 开发挑战

- **上下文连续性**：如何在有限上下文中保持开发连续性
- **代码验证**：确保AI输出的代码实际可用，而非"幻觉"
- **工作划分**：如何合理划分任务使每次会话都能完成有意义的单元
- **知识传递**：如何将前次会话的关键决策和理解传递给新会话
- **质量控制**：如何确保AI理解并遵循项目规范和最佳实践

## 开发会话结构

为保证每次AI开发会话的高效性，建议遵循以下统一结构：

### 1. 会话初始化 (5-10% tokens)

```
【会话ID】: DEV-[功能模块代号]-[序号]-[日期]
【开发目标】: [本次会话要完成的具体功能单元]
【依赖单元】: [本功能依赖的前置功能单元]
【上下文传递】: [上次会话的关键决策和未完成项]
```

### 2. 代码理解阶段 (15-20% tokens)

- 引导AI理解相关的已有代码
- 了解项目结构和相关组件
- 明确本功能单元的技术要求和限制

### 3. 设计确认阶段 (10% tokens)

- 确认功能实现方案
- 讨论技术选择和架构决策
- 明确实现边界和接口定义

### 4. 代码实现阶段 (40-50% tokens)

- 按照确定的方案实现代码
- 特别关注可能出现问题的关键点
- 确保代码符合项目规范和微信小程序限制

### 5. 测试验证阶段 (15-20% tokens)

- 对照验证清单验证功能
- 进行边界条件和异常情况测试
- 编写简单测试用例或验证步骤

### 6. 会话总结 (5% tokens)

- 总结本次完成的功能和遇到的问题
- 记录关键技术决策和考量
- 提出下一步建议和注意事项

## AI开发提示词模板

为保证与AI的高效沟通，以下提供标准提示词模板：

### 会话初始化提示词

```
现在我们进行工作留痕系统的开发工作，会话ID为DEV-[模块代号]-[序号]-[日期]。

本次开发目标是实现[具体功能单元]，该功能的主要作用是[简要功能描述]。
该功能依赖于之前完成的[依赖单元列表]。

关键上下文信息：
1. [上次会话的关键决策点1]
2. [上次会话的关键决策点2]
3. [其他需要了解的背景信息]

首先我们需要了解相关代码，请查看以下文件：
- [关键文件路径1]
- [关键文件路径2]
```

### 问题解决提示词

```
在实现[某功能]过程中遇到了[具体问题]。
错误信息或表现为：[错误信息或现象描述]

我们已经尝试了：
1. [已尝试的解决方案1]
2. [已尝试的解决方案2]

请分析问题原因并提出解决方案。
```

### 验证测试提示词

```
我们已经实现了[功能单元]，现在需要进行验证测试。

请按照验证测试规范中定义的以下检查点进行验证：
1. [检查点1]
2. [检查点2]
3. [检查点3]

对于每个检查点，请给出具体的测试步骤和预期结果。
```

## 开发序列与流程

### 最优开发序列

根据功能依赖关系，工作留痕系统的最优开发序列为：

1. **基础架构层** (A系列)
   - A1: 基础应用架构 → A2: 本地存储管理模块 → A3: 网络状态管理模块 → A4: 数据同步基础框架

2. **核心功能层** (同时开展多条线)
   - **留痕类型流** (E系列)：E1 → E2/E3
   - **照片管理流** (B系列)：B1 → B2 → B3 → B4
   - **文本处理流** (C系列)：C1 → C2 → C3 → C4

3. **功能整合层**
   - **内容处理流** (D系列)：D1 → D2 → D3 → D4
   - 最小可用版本集成测试

4. **增强功能层**
   - **AI功能流** (F系列)：F1 → F2 → F3
   - **体验优化流** (G系列)：G1 → G2 → G3

### 关键检查点设置

在开发过程中设置以下关键检查点：

1. **CP1: 基础架构验证点** - A系列全部完成后
2. **CP2: 核心功能验证点** - E1, B1-B2, C1-C3完成后
3. **CP3: 最小可用版本** - A, E1-E3, B1-B2, C1-C3, D1完成后
4. **CP4: 完整功能集** - 除F、G系列外所有功能完成后
5. **CP5: 最终版本** - 所有功能完成后

每到达检查点，应进行全面的集成测试，确保已开发功能之间的协调一致。

## AI开发会话管理

### 会话记录格式

为每次AI开发会话创建记录，使用以下格式：

```markdown
# 开发会话记录

## 基本信息
- **会话ID**: DEV-[模块代号]-[序号]-[日期]
- **开发目标**: [功能单元]
- **开发日期**: [YYYY-MM-DD]
- **开发状态**: [已完成/部分完成/遇到问题]

## 开发内容摘要
- [简要描述本次实现的功能]
- [关键技术点和决策]
- [创建或修改的文件列表]

## 问题与解决方案
- **问题1**: [问题描述]
  - **解决方案**: [解决方案描述]
- **问题2**: [问题描述]
  - **解决方案**: [解决方案描述]

## 验证测试结果
- [验证项1]: [通过/未通过] - [备注]
- [验证项2]: [通过/未通过] - [备注]

## 下一步行动
- [下一步计划]
- [需要注意的事项]
- [未完成的任务]

## 会话快照
- [会话中关键部分的摘录或截图]
```

### 版本控制策略

1. **提交粒度**：每完成一个功能单元提交一次代码
2. **提交消息格式**：`[功能单元ID]: 简要描述功能实现内容`
3. **分支策略**：
   - `main`: 稳定版本分支
   - `dev`: 开发主分支
   - `feature/[功能ID]`: 功能开发分支

## 常见AI开发陷阱与避免策略

### 1. 代码幻觉问题

**表现**：AI认为某些功能已实现或可用，但实际上不存在或不可用

**避免策略**：
- 每个功能单元实现后立即进行实际验证
- 使用明确的检查点列表验证功能完整性
- 对关键功能点要求AI提供实现细节描述

### 2. 上下文丢失问题

**表现**：新会话中AI无法理解之前的开发决策和进展

**避免策略**：
- 重要决策记录在开发日志中
- 新会话开始时提供简洁但关键的上下文信息
- 关键代码设计思路添加到代码注释中

### 3. 过度设计问题

**表现**：AI过度设计功能，导致复杂度超出必要水平

**避免策略**：
- 明确指定当前功能单元的边界
- 遵循"最小可行实现"原则
- 将复杂功能分解为多个简单功能单元

### 4. 兼容性问题

**表现**：AI生成的代码不符合微信小程序平台限制

**避免策略**：
- 在开发初始明确强调平台限制
- 使用微信小程序专用版本的框架和库
- 验证测试必须包含兼容性检查

## 开发效率提升技巧

1. **代码模板预定义**：预先定义常用的代码模板，减少重复工作

2. **关键代码收藏**：将关键组件实现和核心逻辑代码保存在专门的"代码片段库"中

3. **问题-解决方案库**：记录开发过程中遇到的问题和解决方案，避免重复解决

4. **验证清单自动化**：为常见功能类型创建标准化验证清单

5. **会话并行策略**：对独立功能流可以并行启动多个AI开发会话

## 实践案例

### 案例1: 基础存储模块开发

**会话初始化**:
```
会话ID: DEV-A2-01-20240510
开发目标: 实现本地存储管理模块
依赖单元: A1(基础应用架构)
```

**关键任务分解**:
1. 创建存储管理类 (StorageManager)
2. 实现数据分级存储机制
3. 实现存储空间管理功能
4. 添加必要的错误处理和日志

**验证清单**:
- 能正确存储不同类型数据
- 能按级别管理和清理存储空间
- 应用重启后数据正确恢复
- 错误情况下有适当的降级处理

### 案例2: 照片网格组件开发

**会话初始化**:
```
会话ID: DEV-B2-01-20240512
开发目标: 实现照片管理网格组件
依赖单元: B1(基础拍照功能)
```

**关键任务分解**:
1. 创建照片网格组件 (PhotoGrid)
2. 实现照片拖拽排序功能
3. 实现照片选择和批量操作
4. 优化网格布局和性能

**验证清单**:
- 网格正确显示不同数量照片
- 拖拽排序功能正常工作
- 选择和批量操作功能有效
- 加载10+照片时性能表现良好

## 结论

通过本指南定义的开发序列和方法，可以充分利用AI助手的优势，同时避免常见陷阱，实现高效率、高质量的工作留痕系统开发。关键成功因素包括:

1. 合理的功能拆分和开发序列
2. 严格的验证测试和质量控制
3. 有效的知识传递和会话管理
4. 持续的经验积累和方法优化

随着开发进展，应定期回顾和优化本指南，确保开发方法与项目需求和AI能力保持最佳匹配。 