# 微信小程序云开发极限测试 - 使用说明

> **更新日期**：2025年4月6日

## 使用前准备

在运行极限测试前，请确保满足以下条件：

1. **云开发环境已配置**：
   - 已开通并配置微信小程序云开发环境
   - 已创建必要的数据库集合（users, photos, diaries, traces, settings, feedback）
   - 已部署所有云函数（getOpenId, initDatabase, manageUser, manageFile）

2. **权限与配额**：
   - 确保云环境有足够的资源配额（云函数调用次数、数据库读写次数、存储空间等）
   - 测试账号拥有管理员权限，以便执行所有操作

3. **网络环境**：
   - 保持稳定的网络连接
   - 建议使用有线网络连接电脑，避免测试过程中网络波动

## 运行测试

### 步骤一：进入测试页面

1. 打开微信开发者工具并加载项目
2. 使用以下任一方法进入极限测试页面：

   **方法1：通过导航**
   - 在模拟器中点击进入"云测试"页面
   - 在云测试页面中点击"极限测试"按钮

   **方法2：直接编译指定页面**
   - 在工具栏找到页面选择器(通常是编译按钮旁的下拉菜单)
   - 选择 `pages/cloud-test/extreme-tests/index`
   - 点击"编译"按钮

   **方法3：手动输入路径**
   - 在模拟器顶部地址栏手动输入：`pages/cloud-test/extreme-tests/index`
   - 按回车键确认

### 步骤二：配置测试参数

测试页面加载后，您可以配置以下测试参数：

1. **批量操作测试配置**：
   - 批量大小：每批次操作的数量（默认：20，范围：5-50）
   - 并发限制：同时执行的请求数量（默认：5，范围：1-10）
   - 文件大小：上传文件的大小（默认：100KB，范围：50KB-500KB）

2. **数据完整性测试配置**：
   - 长字符串长度：测试的字符串长度（默认：1MB，范围：0.1MB-5MB）
   - 对象嵌套深度：嵌套JSON对象的层级（默认：30，范围：10-50）
   - 大对象字段数：单个对象的字段数量（默认：200，范围：50-500）

3. **错误处理测试配置**：
   - 测试运行次数：每类错误测试的次数（默认：10，范围：5-30）
   - 网络错误概率：模拟网络错误的概率（默认：30%，范围：10%-60%）
   - 并发操作数：错误测试中的并发数（默认：5，范围：1-10）

4. **全局配置**：
   - 并行运行：是否并行运行所有测试
   - 清理测试数据：每次测试后是否清理数据

### 步骤三：执行测试

1. 配置完测试参数后，您可以选择：
   - 点击"运行所有测试"按钮执行完整测试套件
   - 点击单个模块的"运行测试"按钮仅测试特定功能

2. 测试执行过程中：
   - 页面上会显示进度指示器
   - 测试状态会实时更新
   - 控制台会输出详细日志（按F12或右键检查可查看）

3. 测试完成后：
   - 结果会显示在页面上的对应区域
   - 详细数据会存储在本地缓存中
   - 可点击"导出结果"按钮保存完整报告

## 测试结果解读

测试完成后，您可以查看以下结果：

1. **总体结果**：
   - 测试总数、成功数、失败数
   - 总体成功率和测试耗时

2. **批量操作测试结果**：
   - 云函数、数据库和文件存储操作的成功率
   - 平均响应时间和最大响应时间
   - 性能曲线图

3. **数据完整性测试结果**：
   - 各类数据结构测试的通过状态
   - 实际支持的限制和性能影响

4. **错误处理测试结果**：
   - 各类错误场景的处理结果和恢复能力
   - 错误提示的准确性和有用性评分

## 数据清理

测试过程中会产生大量测试数据，请注意：

1. 启用"测试后清理数据"选项可自动删除测试中产生的数据
2. 若未启用自动清理，可在测试完成后点击"清理测试数据"按钮手动清理
3. 清理范围包括：
   - 测试创建的临时文档
   - 上传的测试文件
   - 测试用的临时集合

## 故障排除

如果测试过程中遇到问题，请尝试：

1. **测试无法启动**：
   - 检查云开发环境是否正确配置
   - 确认云函数已正确部署
   - 查看控制台是否有权限相关错误

2. **测试中断或卡住**：
   - 点击"停止测试"按钮
   - 刷新页面重新开始
   - 减小测试参数（批量大小、并发数等）

3. **结果异常**：
   - 检查网络连接状态
   - 确认云环境资源配额未耗尽
   - 查看云开发控制台中是否有错误日志

4. **其他问题**：
   - 查看开发者工具控制台日志
   - 尝试清除缓存并重新编译项目
   - 检查项目依赖和配置文件

---

*如有其他问题，请联系开发团队获取支持* 