### 前言

* 绣花针 - 多用户办公系统
* 工业级零容错，服务于中国数千万政府基层工作人员和社区居委会/村等人员
* 多用户共生首页，除了每个人有自己的首页、文章列表页，还支持多用户共生首页，例如，张三今天当志愿者，领导要求他将事迹呈现在单位首页，可直接将他的事迹转发到首页，也可以由张三自己呈现在单位首页
* 应用内有即时通讯、工单、客服、管理员面板、数据可视化等，未来考虑接入商品等功能
* 千万级高并发大容量暂时不考虑海外发行
* 登录：用微信扫码、百度、抖音、快手、QQ、苹果、google、GiHub、facebook等都能登录
* 多端：微信小程序、苹果APP、安卓APP、华为APP、苹果电脑网页端、windows电脑网页端，未来还考虑苹果电脑桌面应用、windows电脑桌面应用
* 微信原生设计，要有设计变量共享、组件库覆盖要达到工业级开发必要程度、建立组件文档系统
* 防下载（偷代码），按需下载、用完即删
* 苹果般丝滑
* 容器化：本地开发用devbox，要有完整的devbox配置，确保开发环境完全隔离
* 微服务
* 第一阶段开发微信小程序，过阵子再考虑其它端
* 云端部署AI或用AI的API来进行文章润色、写文章、台账整理等
* 断网可用、弱网可用、离线缓存、异步上传，注意同步冲突解决策略、缓存策略足够智能、网络测试工具足够完善、
* 样式和内容分离
* 性能：
  * 懒加载
  * 按需加载
  * 更细粒度的组件懒加载机制
* 不使用微信小程序的云函数或serverless，目前阶段使用腾讯云服务器
* 自动化验证脚本、自动化测试框架（如Jest、Testing Library）、CI/CD流程、统一的状态管理机制（小程序和Web端）、错误监控与上报及生产环境错误跟踪机制、结构化日志记录和分析机制、前端监控系统、更智能的资源预加载策略、优化图片处理流程，支持渐进式加载、注意离线数据同步算法，减少冲突、
* 安全：
  * 敏感数据加密存储
  * 输入验证和过滤机制
  * 权限管理系统
  * 内容安全策略（CSP）
* 开发：
  * 建立Git工作流规范
  * 代码评审流程
  * 自动化构建和部署
  * 组件文档系统
* 

## 小程序端特别注意事项

* 防关闭。目前小程序如果误操作，就会关闭，重新打开进入，就找不到刚才的页面了，这一点设计得相当不靠谱，但反馈好久，微信仍然无动于衷。因此我想：
  * 记住关闭前的页面和操作状态，例如用户正点击照片操作某事，突然有微信消息过来，用户需要回到微信聊天界面去处理，重新进来时，仍能直接定位到刚才操作暂停的地方，防止重新来过
  * 增加前进后退按钮放在显眼位置

### 写工作留痕

* 留痕分两类，一类是有标题的，一类是没有标题的
  * 有标题的，我称之为文章，类似博客，一堆照片，一堆文字说明
  * 无标题的，我称之为事迹，类似微博，几张照片，一小断文字，例如"某小区入口处发现落地杂物，请及时处理"，并配几张照片
* 在应用的任何地方点击拍照图标。弹出照相机或者相册的选择。界面。如果是相册选择，在选择完图片之后点击确定时，应用就来到了文章编辑界面。以每行三张照片的形式将照片排列起来。如果是拍照，则调用照相机程序。调用照相机程序允许用户设定默认的照相机程序并不一定都是系统的照相机。拍照允许单张拍照或者连续拍照。其中单张拍照是拍一张。收集照相机程序，并且照片确定之后，显示在文章编辑页面。同样是以每行三章的形式显示在开头。如果是连续拍照。则除非用户收起照相机，否则持续拍照。收起照相机之后，照片以每行三张的形式显示在文章编辑页面的开头。拍照是否发出拍照的声音，可以在用户设置里设置。
* 在文章编辑页面，摁住任何一张相片，有一个动效，如有可能。让手机震动一下。震动功能可以在设置里调节开启或关闭以及振动的大小。还可以有音效，音效同样也在用户设置里设置。被摁住的照片原来的位置弹出放大，其他照片同时缩小并处于半透明状态。
* 放大的照片处于屏幕上方的左侧区域，右侧区域是一个麦克风标志。
* 下面是文本编辑区
* 文本编辑区的工具条有加粗字号倾斜等完整功能，最左边是修改错别字的按钮。
* 点击麦克风，会在麦克风的上面出现一个层，这个层是语音输入的界面，也就是说话的时候会有声波界面。此时。对着手机说话。系统能自动抓住用户的语音信息形成文本，实时显示在下方的文本框，一边说一边出现文字，反馈及时没有卡顿或延迟现象。
* 再次点击可关闭麦克风，用户点击文本编辑区工具条上修改错别字的按钮， Ai将自动对刚才语音采集时产生的错别字进行修正，用户检查无误，点击确定。
* 用户也可以手动的用键盘打字的形式来输入文本。
* 点击确定，原本放大的照片以动效的形式回归原位，麦克风消失，文本编辑区消失。其他照片自然放大到原来的位置。
* 默认情况下，每张照片和与之对应的那段文字是一个分组。其他情况，比如说两张或多张图片并组的功能后面再开发。
* 每张图片都可以这么操作。
* 照片可以手动拖拽排序，在文章编辑期间照片可以删除，每张照片的右上方有一个小叉叉，点击小叉叉，图片连同对应的文字一起删除。
* 在文章编辑界面，每张图片的除了右上角的叉叉，左上角还有一个""设为文章封面图""的标志。点击该标志，该图片就成为首页或者是文章列表页或者其他页面的封面图。最多支持三张图片成为封面图。再次点击这个标志，就取消这张图作为封面图片的地位。
* 如果用户不是长按图片来单独设置信息，而是在图片展示界面将屏幕向上滚动，就会露出底下的文本编辑区，在这个界面下的文本编辑区的工具条的最左侧是麦克风和修改错别字按钮，工具条的其他功能不变。这个界面是方便客户直接将所有图片连同文字一起形成一份总体的工作留痕，而不管用户是否针对某一张图片单独设置文字信息。
* 在提交文章之前，这些图片和文字信息暂时储存在用户的设备里。
* 屏幕继续往上滚动，文本编辑区域最底下有两个按钮，一个是直接提交，一个是AI帮写。
* 当点击""直接提交""之后，系统什么也不做，直接将信息和照片一起存到服务器。后面形成的文章阅读页就是一篇刚才原始工作留痕。以一张图片在上对应录音编辑的文字在下、隔一行之后下一张图片和该图片对应的文字形式显示。以此类推。
* 如果点击""AI帮写""，则由ai自动进行全文润色、图片排版，排版时仍然按照用户对图片单独的文字录入，保持图片和文字一一对应的关系。
* 关键词：
  * 不管是直接提交还是形成文章，这篇工作留痕都将自动采集必要的关键词。关键词由多到少形成一定的权重显示，比如说关键词比较多的就显示大一点，关键词少的就显示小一点，颜色也浅一点。不管点击直接提交还是形成文章提交之后，经过一个过渡的页面回到文章列表。暂时不考虑分类。但是点击关键词可以显示与含有该关键词对应的文章列表。并且按照文章中该关键词含量多少来排序。例如点击北京天气这个关键词。某一篇工作留痕。北京天气这个词含量比较多，那么这篇文章就显示在开头。
  * 关键词是动态的。每篇文章都自动采集并形成时间、地点、事件、人物的关键词，当工作留痕有了一定量之后，随后生成的关键词将自动与之匹配成更精准的，并且更新每篇文章的关键词
* 工作留痕编辑界面的文本框，允许复制粘贴excel、markdown等内容进去，也可以点击编辑器工具条上的""上传"，将事先编辑好的excel、markdown、pdf、word等上传进来，经过解译后成为内容
* 工作留痕显示页（文章页）允许显示excel、markdown等表格，而不是让内容散落得乱七八糟

### 任选数据形成台账

* 任选数据形成台账，当个人工作留痕中有了内容后，可跨时间、跨地点、跨事件形成台账，例如在文本框输入""你帮我把2021年4月2号下午到9月9号，我在北海老街当志愿者的事情形成台账""，或者在日历上我滑动到2021年4月2号，里面罗列了我当天的一些事情，我在我认为必要的事件前打勾后，再次翻查日历，又分别在一些日期的具体事件上打勾，点击下一步，或者直接在文本框里写""将这些事件形成台账""。AI自动搜索这些事件的详情，最后归整成一篇台账图文或excel或markdown等表格。
* 数据可视化

### 首页

* 单位首页
  * 每个用户除了有自己的首页，还有共用首页，什么意思呢，例如张三李四是A单位的领导职工，为了宣传该单位的事迹，他们在应用内申请了个单位首页，可申请或自动分配独立域名，例如 abc.xiuhz.com。
  * 电脑版网页，或微信公众号。
  * 单位首页对应是单位后台管理系统，单位的系统管理员可以指定部分干部职工充当内容提供者，也可以将全员设为内容提供者。成员可以将自己的工作留痕展示在单位首页，也可以由管理员或管理员授权的人将部分人或全员的部分事迹或全部事迹推给AI，由AI形成台账。例如，单位要求向社会群众汇报他们在2025年03月25日下午集体到广场义务宣传消防知识这件事都，于是全员将自己那天的事迹推给管理员张三，推送完成后，系统生成以时间脉络的顺序的网页，并在每个事迹前有复选框。张三点击打开该网页，逐个浏览，看顺眼的就打个勾，不合格的就略过。打勾后，张三将网页拉到底下，点击下一步，将这些信息推给AI，AI对信息进行必要加工，形成一篇新闻报导或别的什么格式（在编辑页可设置）的文章并形成网页，张三审阅，发现不足之处，点击编辑按钮进入编辑页，刷刷点点完成编辑，点击""预览按钮""重新形成网页，张三美滋滋认为可以过关于，于是提交给领导，领导醉眼朦胧，看着差不多是这个意思，点击""批准""，返回给张三，张三点击""提交""，该篇文章推送出去。这些工作，可以由管理员张三来做，也可以由他授权的人来做，最后报给张三，再报给领导审批。
  * 所谓""正式推送出去""，是指该文章最终会出现在电脑版首页，或者微信公众号。有什么办法让别的公众号也接入我的应用数据库呢？
* 个人首页
  * 个人首页不使用xiuhz.com这个域名

### 访客界面

* 不管是注册用户，还是非注册用户，在不属于自己的工作留痕浏览界面，他都属于访客

### 搜索功能

* 搜索框实质就是AI搜索，AI搜索的内容包括：

## 信息收集

* 为了应用更快完善，除了设置""开发功能意见收集箱""，我打算收集除隐私以外的用户信息
  * 机型
  * 使用时间
  * 使用地点
  * 进入习惯
  * 停留时间
  * 其它

## 社交功能

* 订阅
