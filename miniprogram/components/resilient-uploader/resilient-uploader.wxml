<view class="resilient-uploader">
  <!-- ç½‘ç»œçŠ¶æ€æç¤º -->
  <view class="network-tip {{showNetworkTip ? 'show' : ''}}" wx:if="{{showNetworkTip}}">
    <view class="network-tip-icon">
      <icon type="{{networkState.connected ? 'info' : 'warn'}}" size="16"></icon>
    </view>
    <view class="network-tip-text">{{networkTip}}</view>
  </view>
  
  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-bar">
    <button class="action-btn primary" bindtap="choosePhoto">é€‰æ‹©ç…§ç‰‡</button>
    <button class="action-btn" bindtap="startUpload" disabled="{{pendingPhotos.length === 0}}">å¼€å§‹ä¸Šä¼ </button>
    <button class="action-btn secondary" bindtap="pauseAllUploads" wx:if="{{isUploading}}">æš‚åœä¸Šä¼ </button>
    <button class="action-btn secondary" bindtap="resumeAllUploads" wx:else>æ¢å¤ä¸Šä¼ </button>
  </view>
  
  <!-- ç½‘ç»œçŠ¶æ€ -->
  <view class="status-bar">
    <view class="network-status">
      <text class="label">ç½‘ç»œçŠ¶æ€:</text>
      <text class="value {{!networkState.connected ? 'error' : networkState.networkType === 'wifi' ? 'success' : ''}}">
        {{networkState.connected ? networkState.networkType : 'å·²æ–­å¼€'}}
      </text>
    </view>
    <view class="network-signal">
      <text class="label">ä¿¡å·å¼ºåº¦:</text>
      <text class="value {{networkState.signalStrength === 'weak' ? 'warning' : networkState.signalStrength === 'strong' ? 'success' : ''}}">
        {{networkState.signalStrength === 'strong' ? 'å¼º' : networkState.signalStrength === 'weak' ? 'å¼±' : 'ä¸­ç­‰'}}
      </text>
    </view>
  </view>
  
  <!-- å¾…ä¸Šä¼ ç…§ç‰‡åˆ—è¡¨ -->
  <view class="photo-section" wx:if="{{pendingPhotos.length > 0}}">
    <view class="section-title">
      <text>å¾…ä¸Šä¼  ({{pendingPhotos.length}})</text>
    </view>
    <view class="photo-list">
      <view class="photo-item" wx:for="{{pendingPhotos}}" wx:key="id">
        <view class="photo-preview">
          <image class="photo-image" src="{{item.path}}" mode="aspectFill"></image>
          <view class="photo-status pending">ç­‰å¾…ä¸Šä¼ </view>
        </view>
        <view class="photo-info">
          <view class="photo-name">{{item.name}}</view>
          <view class="photo-size">{{(item.size / 1024).toFixed(1)}} KB</view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- ä¸Šä¼ ä¸­ç…§ç‰‡åˆ—è¡¨ -->
  <view class="photo-section" wx:if="{{uploadingPhotos.length > 0}}">
    <view class="section-title">
      <text>ä¸Šä¼ ä¸­ ({{uploadingPhotos.length}})</text>
    </view>
    <view class="photo-list">
      <view class="photo-item" wx:for="{{uploadingPhotos}}" wx:key="id">
        <view class="photo-preview">
          <image class="photo-image" src="{{item.path}}" mode="aspectFill"></image>
          <view class="photo-status uploading">ä¸Šä¼ ä¸­</view>
        </view>
        <view class="photo-info">
          <view class="photo-name">{{item.name}}</view>
          <view class="photo-progress">
            <progress percent="{{item.progress}}" stroke-width="3" activeColor="#007aff"></progress>
            <text class="progress-text">{{item.progress}}%</text>
          </view>
          <view class="photo-actions">
            <button class="photo-btn cancel" data-task-id="{{item.taskId}}" bindtap="cancelUpload">å–æ¶ˆ</button>
          </view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- ä¸Šä¼ å¤±è´¥ç…§ç‰‡åˆ—è¡¨ -->
  <view class="photo-section" wx:if="{{failedPhotos.length > 0}}">
    <view class="section-title">
      <text>ä¸Šä¼ å¤±è´¥ ({{failedPhotos.length}})</text>
    </view>
    <view class="photo-list">
      <view class="photo-item" wx:for="{{failedPhotos}}" wx:key="id">
        <view class="photo-preview">
          <image class="photo-image" src="{{item.path}}" mode="aspectFill"></image>
          <view class="photo-status failed">ä¸Šä¼ å¤±è´¥</view>
        </view>
        <view class="photo-info">
          <view class="photo-name">{{item.name}}</view>
          <view class="photo-error" wx:if="{{item.error}}">
            {{item.error.errMsg || item.error.message || 'ä¸Šä¼ å‡ºé”™'}}
          </view>
          <view class="photo-actions">
            <button class="photo-btn retry" data-photo-id="{{item.id}}" bindtap="retryUpload">é‡è¯•</button>
          </view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- å·²ä¸Šä¼ ç…§ç‰‡åˆ—è¡¨ -->
  <view class="photo-section" wx:if="{{uploadedPhotos.length > 0}}">
    <view class="section-title">
      <text>å·²ä¸Šä¼  ({{uploadedPhotos.length}})</text>
      <view class="section-actions">
        <button class="section-btn" bindtap="clearUploadedPhotos">æ¸…é™¤</button>
      </view>
    </view>
    <view class="photo-list">
      <view class="photo-item" wx:for="{{uploadedPhotos}}" wx:key="id">
        <view class="photo-preview">
          <image class="photo-image" src="{{item.path}}" mode="aspectFill"></image>
          <view class="photo-status completed">ä¸Šä¼ å®Œæˆ</view>
        </view>
        <view class="photo-info">
          <view class="photo-name">{{item.name}}</view>
          <view class="photo-size">{{(item.size / 1024).toFixed(1)}} KB</view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- ç©ºçŠ¶æ€æç¤º -->
  <view class="empty-state" wx:if="{{pendingPhotos.length === 0 && uploadingPhotos.length === 0 && failedPhotos.length === 0 && uploadedPhotos.length === 0}}">
    <view class="empty-icon">ğŸ“·</view>
    <view class="empty-text">ç‚¹å‡»"é€‰æ‹©ç…§ç‰‡"æŒ‰é’®å¼€å§‹ä¸Šä¼ </view>
    <view class="empty-subtext">æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œå¼±ç½‘ç¯å¢ƒä¹Ÿèƒ½ç¨³å®šä¸Šä¼ </view>
  </view>
</view> 