# 极端测试套件：异常输入测试 (XT-02)

## 测试套件概述

本测试套件专注于通过向B1基础照片采集功能提供各种非预期、极端和错误的输入，测试系统的容错能力、安全性和稳定性。异常输入测试通过模拟用户的非正常操作、注入无效数据和制造边界条件，检验应用的异常处理机制是否健全。

**优先级:** A（最高）

## 测试先决条件

1. 已安装最新版本的小程序
2. 测试设备权限已完全开启（相机、存储、网络等）
3. 开发者调试工具已配置完成
4. 模拟数据注入工具已准备就绪（如适用）
5. 网络代理工具已设置（如需拦截/修改网络请求）

## 测试用例清单

| 用例ID | 测试名称 | 优先级 | 测试类型 | 自动化可行性 |
|-------|---------|-------|---------|------------|
| XT02-001 | 特殊字符和符号输入测试 | 高 | 安全性/功能 | 可行 |
| XT02-002 | 极端长度文件名测试 | 高 | 功能/边界 | 可行 |
| XT02-003 | 注入无效照片数据 | 高 | 安全性/功能 | 部分可行 |
| XT02-004 | 快速连续操作测试 | 高 | 稳定性 | 可行 |
| XT02-005 | 无效参数传递测试 | 中 | 功能/安全性 | 可行 |
| XT02-006 | 异常照片元数据测试 | 中 | 功能 | 可行 |
| XT02-007 | 中断操作序列测试 | 高 | 稳定性 | 部分可行 |
| XT02-008 | 畸形图片格式测试 | 中 | 功能/安全性 | 可行 |

## 详细测试用例

### XT02-001: 特殊字符和符号输入测试

**目的:** 验证系统对包含特殊字符的输入的处理能力，防止注入攻击和数据处理错误

**优先级:** 高  
**测试类型:** 安全性/功能  
**前置条件:**
- 小程序已安装且可正常运行
- 测试设备支持相机功能

**测试步骤:**
1. 启动小程序并进入照片采集页面
2. 尝试在所有输入项（文件名、描述、标签等）中输入以下特殊字符:
   - SQL注入字符: `'`, `"`, `;`, `--`, `=`, `(`, `)`
   - HTML/JavaScript注入: `<script>`, `</script>`, `<img>`, `onload=`
   - 路径操作字符: `../`, `./`, `/`, `\`
   - 特殊Unicode字符和表情符号
   - 超长字符串（如1000个字符）
3. 在每次输入后尝试保存、提交数据
4. 检查应用响应和数据处理结果

**预期结果:**
1. 应用应正确验证并过滤或转义所有特殊字符
2. 不应出现SQL注入、XSS或其他安全漏洞
3. 应用不应因特殊字符输入而崩溃或卡死
4. 应提供适当的错误提示，指导用户输入有效内容
5. 超长字符串应被截断或拒绝，并给予明确提示

**测试数据:**
- 特殊字符测试集（包含各类潜在危险字符）
- 极长字符串（不同长度测试）
- Unicode字符和表情符号集

**清理步骤:**
1. 删除测试过程中创建的所有文件
2. 重置应用状态

---

### XT02-002: 极端长度文件名测试

**目的:** 验证系统对极端长度文件名的处理能力，确保文件系统操作安全和稳定

**优先级:** 高  
**测试类型:** 功能/边界  
**前置条件:**
- 小程序已安装且可正常运行
- 测试设备具有足够存储空间
- 已知系统文件名长度限制（一般为255字符）

**测试步骤:**
1. 启动小程序并进入照片采集页面
2. 拍摄照片并尝试使用以下文件名长度保存:
   - 接近系统限制的长文件名（如250字符）
   - 超过系统限制的文件名（如300字符）
   - 极短文件名（1-2个字符）
   - 含有多个点的文件名（如"photo.test.jpg.png"）
3. 尝试读取、预览和编辑这些极端文件名的照片
4. 测试这些照片的云端上传功能（如果有）

**预期结果:**
1. 应用应限制文件名长度，不允许超过系统支持的最大长度
2. 对于过长文件名，应提供友好错误提示或自动截断
3. 极短或含多点的文件名应能正确处理，不影响文件操作
4. 所有文件操作（保存、读取、预览、编辑、上传）应保持稳定

**测试数据:**
- 各种长度的文件名测试集
- 文件操作成功率记录
- 错误提示内容记录

**清理步骤:**
1. 删除测试过程中创建的所有文件
2. 清理云端存储中的测试文件（如适用）

---

### XT02-003: 注入无效照片数据

**目的:** 验证系统在处理无效或损坏的照片数据时的健壮性和安全性

**优先级:** 高  
**测试类型:** 安全性/功能  
**前置条件:**
- 小程序已安装且可正常运行
- 已准备各种损坏或无效的照片文件
- 具备文件注入能力或权限

**测试步骤:**
1. 准备以下类型的异常照片文件：
   - 头部信息损坏的JPEG/PNG文件
   - 空文件（0字节）
   - 超大图片文件（如50MB以上）
   - 格式有效但内容损坏的图片文件
   - 伪装成图片的非图片文件（如改扩展名的文本文件）
2. 通过相册选择功能或直接注入方式将这些文件导入小程序
3. 尝试预览、编辑和处理这些无效照片
4. 观察应用行为和错误处理机制

**预期结果:**
1. 应用应能检测并拒绝处理无效照片文件
2. 对各类异常文件应提供明确错误提示，而非崩溃
3. 一个无效文件不应影响其他正常照片的处理
4. 应用应优雅处理所有异常情况，如遇严重问题可退出但不应崩溃
5. 不应存在可利用的安全漏洞（如通过注入恶意图片执行代码）

**测试数据:**
- 各类异常照片文件集
- 应用响应和错误处理记录
- 安全测试结果记录

**清理步骤:**
1. 删除所有注入的异常文件
2. 重启应用以确保状态正常

---

### XT02-004: 快速连续操作测试

**目的:** 验证系统在面对用户快速、混乱或非预期顺序的操作时的稳定性

**优先级:** 高  
**测试类型:** 稳定性  
**前置条件:**
- 小程序已安装且可正常运行
- 测试设备支持多点触控

**测试步骤:**
1. 启动小程序并进入照片采集页面
2. 执行以下快速连续操作测试场景：
   - 快速连续点击拍照按钮（每秒多次）
   - 在照片正在保存过程中切换到预览模式
   - 在预览加载过程中快速滑动切换多张照片
   - 同时使用多个手指操作不同控件（如同时点击拍照和设置）
   - 在照片上传过程中尝试删除该照片
   - 拍照后立即关闭应用再重新打开
3. 在每个操作序列后检查应用状态和数据完整性

**预期结果:**
1. 应用应能处理快速连续操作，可能会限制操作频率但不应崩溃
2. 对于冲突操作（如正在保存时尝试预览），应合理排队或拒绝
3. 多点触控操作应被正确处理或以可预测方式拒绝
4. 中断操作应不会导致数据损坏或应用异常
5. 应用应维持一致的状态，即使在极端操作条件下

**测试数据:**
- 操作序列及其响应时间记录
- 操作冲突处理方式记录
- 应用状态一致性检查结果

**清理步骤:**
1. 重启应用以恢复正常状态
2. 删除测试过程中产生的照片

---

### XT02-005: 无效参数传递测试

**目的:** 验证应用对接收到的无效或非预期参数的处理能力

**优先级:** 中  
**测试类型:** 功能/安全性  
**前置条件:**
- 小程序已安装且可正常运行
- 具备页面参数注入能力
- 有权限访问开发者调试工具

**测试步骤:**
1. 使用开发者工具，尝试以下参数操作：
   - 向照片采集页面传递无效分辨率参数（如"resolution=invalid"）
   - 传递极端数值（如"timerDelay=999999"）
   - 传递特殊字符（如"mode=<script>alert(1)</script>"）
   - 传递缺失必要参数的页面跳转
   - 传递类型错误的参数（如数字位置传递字符串）
2. 观察应用是否正确验证参数并提供默认值
3. 检查应用响应和错误处理机制

**预期结果:**
1. 应用应验证所有输入参数并拒绝无效值
2. 对于无效参数，应使用安全的默认值
3. 特殊字符应被正确转义，防止代码注入
4. 缺失参数应不影响核心功能，应用应继续工作
5. 不应存在通过参数操作导致的应用崩溃或安全漏洞

**测试数据:**
- 参数测试集（包含各类异常值）
- 参数验证与处理记录
- 默认值应用记录

**清理步骤:**
1. 使用正常参数重启应用
2. 清除开发者工具设置的任何测试参数

---

### XT02-006: 异常照片元数据测试

**目的:** 验证应用对照片元数据（EXIF等）异常情况的处理能力

**优先级:** 中  
**测试类型:** 功能  
**前置条件:**
- 小程序已安装且可正常运行
- 已准备含有各种异常元数据的测试照片
- 相册访问权限已授予

**测试步骤:**
1. 准备以下含有异常元数据的照片:
   - 缺失关键EXIF信息的照片
   - 包含极端大量EXIF数据的照片
   - 包含错误格式EXIF数据的照片
   - 包含异常地理位置信息的照片（如无效坐标）
   - 包含非标准或自定义元数据字段的照片
2. 将这些照片导入设备相册
3. 通过小程序的相册导入功能（如有）选择这些照片
4. 观察元数据处理和显示情况

**预期结果:**
1. 应用应能处理缺失元数据的情况，使用默认值或显示"未知"
2. 异常元数据不应导致加载失败或应用崩溃
3. 无效的地理位置或其他元数据应被忽略或以友好方式提示
4. 应用应限制处理的元数据大小，防止过量元数据导致性能问题
5. 非标准元数据应被安全忽略，不影响核心功能

**测试数据:**
- 异常元数据照片集及其特征记录
- 元数据处理结果记录
- 应用响应时间和性能影响记录

**清理步骤:**
1. 删除导入的测试照片
2. 清理应用中可能缓存的元数据信息

---

### XT02-007: 中断操作序列测试

**目的:** 验证系统在各种操作被意外中断时的数据完整性和恢复能力

**优先级:** 高  
**测试类型:** 稳定性  
**前置条件:**
- 小程序已安装且可正常运行
- 测试环境允许强制中断应用

**测试步骤:**
1. 在以下关键操作过程中强制中断应用：
   - 照片拍摄过程中（曝光或保存阶段）
   - 照片上传云端过程中（如适用）
   - 批量操作执行过程中
   - 照片编辑保存过程中
   - 应用设置更改过程中
2. 中断方式包括：
   - 强制关闭应用
   - 切换至其他应用
   - 设备锁屏
   - 来电打断
   - 网络中断（如适用）
3. 中断后重新启动应用，检查状态恢复和数据完整性

**预期结果:**
1. 关键操作被中断后，已完成的部分应正确保存
2. 未完成的操作应得到适当处理（放弃或提示恢复）
3. 应用不应因中断操作而处于不一致状态
4. 重启后应提供明确提示，告知用户中断前状态
5. 数据应保持一致性，不出现部分保存或损坏的情况

**测试数据:**
- 各类中断场景及其影响记录
- 恢复成功率统计
- 数据完整性检查结果

**清理步骤:**
1. 完成所有未完成的操作或清理部分完成的数据
2. 确保应用恢复到一致状态

---

### XT02-008: 畸形图片格式测试

**目的:** 验证系统对非标准、畸形或边缘情况图片格式的处理能力

**优先级:** 中  
**测试类型:** 功能/安全性  
**前置条件:**
- 小程序已安装且可正常运行
- 已准备各种畸形格式的测试图片
- 相册访问权限已授予

**测试步骤:**
1. 准备以下类型的畸形图片文件：
   - 不符合标准但仍可解码的JPEG/PNG文件
   - 极端宽高比的图片（如1x10000像素或10000x1像素）
   - 极小分辨率图片（如1x1像素）
   - 使用极少见色彩模式的图片（如索引色、灰度+alpha等）
   - 具有异常大调色板的PNG图片
   - 具有非标准压缩算法的图片
2. 通过相册选择功能导入这些图片
3. 尝试查看、编辑和处理这些图片
4. 观察应用响应和错误处理情况

**预期结果:**
1. 应用应尝试处理非标准图片，在能力范围内显示它们
2. 对于无法处理的格式，应提供明确错误提示
3. 极端尺寸图片应得到合理处理，如适当缩放或裁剪
4. 不应因处理畸形图片而导致应用崩溃
5. 应确保资源（如内存）在处理异常图片后得到正确释放

**测试数据:**
- 畸形图片测试集及其特征记录
- 处理成功率和方式记录
- 资源使用监控数据

**清理步骤:**
1. 删除导入的所有测试图片
2. 清理应用缓存

## 测试环境配置说明

### 特殊字符输入准备
1. 准备包含各类特殊字符的文本文件，便于复制粘贴
2. 在测试设备上启用各种特殊字符输入法（如表情符号输入法）
3. 针对无法直接输入的字符，准备预设的剪贴板内容

### 异常文件准备
1. 使用图片编辑工具制作各种异常格式图片
2. 使用十六进制编辑器手动修改图片文件结构制造畸形图片
3. 准备脚本自动生成极端尺寸或特征的图片文件

### 快速操作测试准备
1. 考虑使用自动化测试工具模拟快速点击和操作
2. 准备测试脚本实现精确时间控制的操作序列
3. 多人协作测试可同时触发不同操作

## 测试数据收集指南

对于异常输入测试，应重点收集以下数据：

1. **输入验证记录**
   - 各类异常输入的验证方式
   - 验证失败时的错误消息
   - 默认值应用情况

2. **安全性指标**
   - 是否存在绕过输入验证的方法
   - 是否存在代码注入漏洞
   - 错误处理机制是否泄露敏感信息

3. **稳定性指标**
   - 异常输入导致的崩溃率
   - 操作中断后的恢复成功率
   - 数据一致性维护情况

4. **性能影响**
   - 处理异常输入对性能的影响
   - 资源使用情况（内存、CPU）
   - 处理超大或异常数据的响应时间

## 测试结果评估标准

| 评估项目 | 通过标准 | 不通过标准 |
|---------|---------|-----------|
| 输入验证 | 能正确验证并处理所有异常输入 | 存在验证绕过或处理不当 |
| 错误处理 | 所有异常情况均有友好提示 | 存在无提示失败或不明确错误信息 |
| 稳定性 | 异常输入不导致崩溃或数据损坏 | 出现未处理异常或应用退出 |
| 安全性 | 无可利用的输入相关安全漏洞 | 存在通过异常输入可利用的漏洞 |
| 用户体验 | 对异常输入提供明确指导和解决方案 | 用户无法理解错误或采取恢复措施 |

---

创建日期: 2024-04-06
最后更新: 2024-04-06
版本: 1.0
作者: 资方测试团队 