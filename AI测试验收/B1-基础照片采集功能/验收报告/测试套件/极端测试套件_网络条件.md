# 极端测试套件：网络极端条件测试 (XT-03)

## 测试套件概述

本测试套件针对B1基础照片采集功能在各种极端网络环境下的表现进行全面测试，验证其在不稳定、受限或异常网络条件下的稳定性、容错能力和用户体验。网络极端条件测试模拟现实世界中可能遇到的各种网络问题，确保应用在非理想环境中仍能可靠运行。

**优先级:** A（最高）

## 测试先决条件

1. 已安装最新版本的小程序
2. 测试设备已配置网络控制工具（如Charles、Proxyman或专用网络模拟器）
3. 测试设备可切换不同网络环境（WiFi、移动数据、无网络等）
4. 云存储功能（如有）已正确配置
5. 监控和分析工具已准备就绪

## 测试用例清单

| 用例ID | 测试名称 | 优先级 | 测试类型 | 自动化可行性 |
|-------|---------|-------|---------|------------|
| XT03-001 | 弱网环境照片上传 | 高 | 功能/可靠性 | 可行 |
| XT03-002 | 网络中断恢复测试 | 高 | 功能/恢复能力 | 可行 |
| XT03-003 | 高延迟网络环境测试 | 中 | 性能/用户体验 | 可行 |
| XT03-004 | 网络切换稳定性测试 | 高 | 可靠性 | 可行 |
| XT03-005 | 网络数据包丢失测试 | 中 | 可靠性 | 可行 |
| XT03-006 | 网络超时处理测试 | 高 | 功能/恢复能力 | 可行 |
| XT03-007 | 网络安全降级测试 | 中 | 安全性 | 可行 |

## 详细测试用例

### XT03-001: 弱网环境照片上传

**目的:** 验证在弱网络环境下照片上传功能的可靠性和性能表现

**优先级:** 高  
**测试类型:** 功能/可靠性  
**前置条件:** 
- 小程序已安装且可正常运行
- 网络限速工具已配置（限制带宽为50-100Kbps）
- 测试设备已启用照片云同步功能（如有）

**测试步骤:**
1. 使用网络工具将上传带宽限制在50-100Kbps
2. 启动小程序并进入照片采集页面
3. 拍摄5张不同分辨率的照片
4. 尝试将照片上传到云端存储（若支持此功能）
5. 在上传过程中观察应用行为和反馈
6. 上传过程中临时降低带宽至20Kbps，持续30秒后恢复
7. 完成后检查云端照片是否完整保存

**预期结果:**
1. 应用应能识别弱网状态并提供适当提示
2. 所有照片均应成功上传，即使需要较长时间
3. 应用应显示准确的上传进度或状态信息
4. 带宽变化时，上传应继续进行而非失败
5. 如上传暂时失败，应有自动重试机制
6. 所有云端保存的照片应与原始照片一致，无损坏

**测试数据:**
- 上传速度和完成时间记录
- 上传成功率统计
- 带宽变化时的应用行为记录
- 错误提示和重试机制评价

**清理步骤:**
1. 删除云端存储的测试照片
2. 恢复正常网络设置
3. 清理测试过程中产生的本地照片

---

### XT03-002: 网络中断恢复测试

**目的:** 验证应用在网络完全中断后恢复时的数据一致性和功能连续性

**优先级:** 高  
**测试类型:** 功能/恢复能力  
**前置条件:** 
- 小程序已安装且可正常运行
- 测试设备可快速切换网络状态

**测试步骤:**
1. 启动小程序并进入照片采集页面
2. 拍摄3张照片，开始上传至云端
3. 在上传过程中（约30%进度时）完全断开网络连接
4. 保持断网状态1分钟，继续操作应用（如拍摄更多照片）
5. 恢复网络连接，观察应用行为
6. 检查之前中断的上传是否自动恢复
7. 重新进入上传界面，确认所有照片状态正确显示

**预期结果:**
1. 网络中断时应用应提供明确错误提示
2. 本地功能（拍照、预览等）应在断网状态下保持可用
3. 网络恢复后，应用应能自动检测到连接恢复
4. 中断的上传任务应自动恢复或提供手动恢复选项
5. 上传状态应正确反映，已完成和未完成的任务应区分明确
6. 无论网络状态如何变化，本地数据不应丢失或损坏

**测试数据:**
- 网络状态变化记录
- 上传恢复成功率
- 断网期间本地功能可用性评估
- 网络恢复检测时间测量

**清理步骤:**
1. 确保所有上传任务完成或取消
2. 删除云端和本地的测试照片

---

### XT03-003: 高延迟网络环境测试

**目的:** 验证在网络延迟极高的情况下应用的响应性和用户体验

**优先级:** 中  
**测试类型:** 性能/用户体验  
**前置条件:** 
- 小程序已安装且可正常运行
- 网络延迟模拟工具已配置（可设置300-1000ms延迟）

**测试步骤:**
1. 使用网络工具设置网络延迟为300ms
2. 启动小程序并进入照片采集页面
3. 执行常规操作（拍照、预览、上传等）
4. 逐步增加网络延迟至500ms、800ms和1000ms
5. 在每个延迟级别下执行相同的操作集
6. 观察应用响应时间和用户体验变化

**预期结果:**
1. 网络延迟不应影响本地功能（如拍照、本地预览）的响应速度
2. 云端功能（如上传、同步）在高延迟下仍能正常工作，但可能较慢
3. 应用界面应保持响应，不应因网络请求等待而冻结
4. 在极高延迟（800ms+）下，应提供适当的加载指示或反馈
5. 即使在高延迟环境下，关键操作（如照片保存）也不应失败

**测试数据:**
- 不同延迟级别下的操作响应时间
- 用户界面响应性评分
- 功能成功率与延迟的相关性分析
- 加载指示器的用户体验评估

**清理步骤:**
1. 恢复正常网络设置
2. 删除测试产生的照片

---

### XT03-004: 网络切换稳定性测试

**目的:** 验证应用在不同网络环境间频繁切换时的稳定性和数据一致性

**优先级:** 高  
**测试类型:** 可靠性  
**前置条件:** 
- 小程序已安装且可正常运行
- 测试设备可同时接入WiFi和移动数据网络
- 照片云同步功能已启用（如支持）

**测试步骤:**
1. 确保设备同时连接WiFi和移动数据
2. 启动小程序并进入照片采集页面
3. 拍摄照片并开始上传
4. 在上传过程中，执行以下网络切换：
   - WiFi→移动数据→WiFi
   - 开启飞行模式2秒后关闭
   - 切换到不同的WiFi网络
5. F在每次网络切换后观察应用行为
6. 完成全部测试后检查照片上传状态和数据一致性

**预期结果:**
1. 网络切换过程中应用不应崩溃或卡死
2. 上传中的操作应在网络恢复后自动继续或提供恢复选项
3. 切换后的网络状态应被正确检测和处理
4. 短暂的网络中断（如飞行模式）不应导致整个操作失败
5. 网络环境变化应对用户透明，最小化用户干预需求
6. 数据一致性应保持，不应出现部分上传或损坏的照片

**测试数据:**
- 不同网络切换场景的处理结果记录
- 操作连续性评分
- 恢复机制有效性评估
- 数据一致性检查结果

**清理步骤:**
1. 恢复稳定网络环境
2. 删除所有测试照片

---

### XT03-005: 网络数据包丢失测试

**目的:** 验证在网络数据包丢失严重的情况下，应用的容错能力和数据完整性保障

**优先级:** 中  
**测试类型:** 可靠性  
**前置条件:** 
- 小程序已安装且可正常运行
- 网络包丢失模拟工具已配置（可设置5%-30%丢包率）

**测试步骤:**
1. 使用网络工具设置5%的数据包丢失率
2. 启动小程序并进入照片采集页面
3. 拍摄照片并尝试上传
4. 逐步增加丢包率至10%、20%和30%
5. 在每个丢包级别下执行相同的上传操作
6. 观察应用的重试机制和错误处理
7. 检查最终上传完成的照片质量和完整性

**预期结果:**
1. 轻微丢包（5-10%）不应明显影响应用功能
2. 中度丢包（10-20%）下应用应有效重试，可能速度变慢但功能正常
3. 严重丢包（20-30%）下应用应提供明确错误提示，并具备恢复机制
4. 所有成功上传的照片应保持数据完整性，不出现损坏
5. 即使在高丢包率下，应用也不应崩溃或进入不可恢复状态

**测试数据:**
- 不同丢包率下的上传成功率
- 重试次数和策略评估
- 上传完成时间与丢包率关系
- 数据完整性验证结果

**清理步骤:**
1. 恢复正常网络设置
2. 删除测试产生的照片

---

### XT03-006: 网络超时处理测试

**目的:** 验证应用对网络请求超时的处理机制和用户体验保障

**优先级:** 高  
**测试类型:** 功能/恢复能力  
**前置条件:** 
- 小程序已安装且可正常运行
- 网络请求拦截/模拟工具已配置

**测试步骤:**
1. 使用网络工具为特定请求设置超时（不返回响应）
2. 分别测试以下场景的超时处理：
   - 应用启动时的初始化请求
   - 照片上传请求
   - 云端照片列表加载请求
   - 设置同步请求
3. 对每种请求类型，模拟不同超时时长（5秒、30秒、60秒）
4. 观察应用的超时检测和恢复机制
5. 评估超时情况下的用户体验和提示信息

**预期结果:**
1. 应用应为所有网络请求设置合理的超时限制
2. 超时发生时应提供清晰的错误提示，不应无限等待
3. 非关键请求超时不应影响应用其他功能的正常使用
4. 关键请求超时应提供重试选项或替代方案
5. 用户界面不应因请求超时而被锁定或变得无响应
6. 从超时状态恢复应简单直观，无需复杂的用户操作

**测试数据:**
- 超时检测时间记录
- 不同请求类型的超时处理对比
- 用户提示信息的清晰度和有效性评估
- 功能恢复方式和成功率统计

**清理步骤:**
1. 关闭网络请求拦截
2. 重启应用确保状态正常

---

### XT03-007: 网络安全降级测试

**目的:** 验证应用在面对网络安全条件降级时的安全保障机制和敏感操作处理

**优先级:** 中  
**测试类型:** 安全性  
**前置条件:** 
- 小程序已安装且可正常运行
- 网络代理和中间人攻击模拟工具已配置
- 测试设备已安装自签名证书（如需要）

**测试步骤:**
1. 配置中间人代理以捕获应用网络流量
2. 模拟以下网络安全降级场景：
   - HTTPS连接降级到HTTP
   - SSL证书验证失败
   - 弱加密算法连接
   - 明文数据传输
3. 在每种场景下执行敏感操作（如照片上传、用户认证）
4. 观察应用的安全检测和防护措施
5. 尝试分析捕获的流量，评估敏感数据保护情况

**预期结果:**
1. 应用应拒绝不安全的连接，特别是涉及敏感数据传输时
2. 证书验证失败时应给出明确警告，并拒绝继续操作
3. 应用不应在不安全连接上传输敏感数据（如用户凭证）
4. 即使网络安全降级，本地数据也应保持安全
5. 应提供适当的用户提示，解释安全问题和可能的解决方法

**测试数据:**
- 安全降级检测成功率
- 敏感数据保护评估结果
- 用户安全提示清晰度评分
- 不同降级场景下应用行为记录

**清理步骤:**
1. 移除代理设置和自签名证书
2. 恢复正常安全网络环境
3. 清除可能在测试过程中捕获的敏感数据

## 测试环境配置说明

### 网络带宽限制配置
1. 使用Charles或Network Link Conditioner等工具限制网络带宽
2. 对于iOS设备，可使用开发者设置中的网络调节功能
3. 对于Android设备，可使用开发者选项中的网络限制功能
4. 服务器端可使用nginx或类似工具进行带宽限制测试

### 网络延迟模拟
1. 配置网络工具添加固定延迟（如300ms-1000ms）
2. 使用具有可变延迟功能的工具模拟不稳定网络
3. 结合地理位置远程服务器测试真实的高延迟环境

### 丢包率设置
1. 使用专业网络模拟工具（如Clumsy）设置特定丢包率
2. 对于复杂场景，可设置丢包模式（随机丢包或突发丢包）
3. 不同丢包率测试应在相同网络环境下进行，确保对比有效

### 网络切换环境
1. 准备多个WiFi网络和移动数据环境
2. 设置部分WiFi为弱信号或不稳定连接
3. 考虑使用网络切换自动化工具提高测试效率

## 测试数据收集指南

对于网络极端条件测试，应重点收集以下数据：

1. **可靠性指标**
   - 不同网络条件下操作的成功率
   - 失败后恢复的成功率和时间
   - 连续操作中的故障频率

2. **性能指标**
   - 各种网络条件下的响应时间
   - 上传/下载速度与网络条件的关系
   - 应用资源使用（CPU、内存）与网络状况关系

3. **用户体验指标**
   - 加载指示器的适当性评分
   - 错误信息的清晰度和有用性
   - 网络问题解决指导的有效性
   - 操作连续性评估

4. **安全评估**
   - 敏感数据在不同网络条件下的保护情况
   - 安全机制对网络攻击的防御能力
   - 证书验证和加密实施的有效性

## 测试结果评估标准

| 评估项目 | 通过标准 | 不通过标准 |
|---------|---------|-----------|
| 弱网可用性 | 在最低50Kbps带宽下核心功能仍可用 | 弱网下功能完全失效或崩溃 |
| 恢复能力 | 网络恢复后能自动继续中断的操作 | 网络中断导致不可恢复的错误状态 |
| 超时处理 | 所有网络请求有合理超时限制和处理 | 存在无限等待或超时后无法恢复的情况 |
| 数据完整性 | 网络问题不影响已保存数据的完整性 | 网络波动导致数据损坏或丢失 |
| 安全保障 | 在不安全网络环境下拒绝敏感操作 | 在不安全连接上传输敏感数据 |
| 用户体验 | 网络问题提供清晰提示和解决方案 | 网络错误提示不明确或无帮助 |

---

创建日期: 2024-04-06
最后更新: 2024-04-06
版本: 1.0
作者: 资方测试团队 